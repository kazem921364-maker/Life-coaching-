<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø³Ù†Ø¬Ø´ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ø±Ø´Ø¯ ÙØ±Ø¯ÛŒ</title>
<style>
body { font-family: Tahoma, sans-serif; padding: 20px; direction: rtl; }
h2 { color: #2c3e50; }
h3 { color: #34495e; margin-top: 5px; }
.area { margin-bottom: 15px; }
label { margin-left: 10px; }
button { margin-top: 20px; padding: 10px 20px; font-size: 16px; margin-right: 10px; }
.result { margin-top: 20px; padding: 15px; border: 1px solid #ccc; background: #f9f9f9; white-space: pre-wrap; }
</style>
</head>
<body>
<h2>ÙØ±Ù… Ø³Ù†Ø¬Ø´ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ø±Ø´Ø¯ ÙØ±Ø¯ÛŒ</h2>
<h3>Ù…Ø¯Ø±Ø³ Ø¯ÙˆØ±Ù‡: Ù…Ø±Ø¨ÛŒ Ø®Ø§Ù†Ù… ÙÙ‡ÛŒÙ…Ù‡ Ø­ÛŒØ§ØªÛŒ</h3>
<hr>
<form id="growthForm">
  <div>
    <label>Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ:</label>
    <input type="text" id="name" required>
  </div>
  <div>
    <label>Ø³Ù†:</label>
    <input type="number" id="age" required>
  </div>
  <div>
    <label>Ø´ØºÙ„ / ÙˆØ¶Ø¹ÛŒØª Ø§Ø´ØªØºØ§Ù„:</label>
    <input type="text" id="job" required>
  </div>
  <div>
    <label>Ù‡Ø¯Ù Ø§Ø² Ø´Ø±Ú©Øª Ø¯Ø± Ø¯ÙˆØ±Ù‡:</label>
    <input type="text" id="goal" required>
  </div>
  <hr>
  <div id="questions" style="max-height:500px;overflow:auto;"></div>
  <button type="button" onclick="calculateResults()">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù†ØªØ§ÛŒØ¬</button>
  <button type="button" onclick="downloadCSV()">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†ØªØ§ÛŒØ¬ CSV</button>
</form>
<div class="result" id="resultDiv" style="display:none"></div>

<script>
const areas = [
  "Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø±Ø§Ø¯Ù‡", "Ù…Ø¯ÛŒØ±ÛŒØª Ø²Ù…Ø§Ù†", "Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø³ØªØ±Ø³", "Ø¨Ø§Ø²Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ø®ÙˆØ¯",
  "Ù…Ù‡Ø§Ø±Øª Ù†Ù‡ Ú¯ÙØªÙ†", "ØªØ¹Ø§Ø¯Ù„ Ú©Ø§Ø± Ùˆ Ø²Ù†Ø¯Ú¯ÛŒ", "Ù‡Ù†Ø± Ù…ØªÙ‚Ø§Ø¹Ø¯Ø³Ø§Ø²ÛŒ", "ØºÙ„Ø¨Ù‡ Ø¨Ø± Ø§Ù‡Ù…Ø§Ù„â€ŒÚ©Ø§Ø±ÛŒ",
  "Ú©Ù†ØªØ±Ù„ Ø®Ø´Ù… Ùˆ Ø¹ØµØ¨Ø§Ù†ÛŒØª", "Ø§Ø±ØªØ¨Ø§Ø· Ù…Ø¤Ø«Ø±", "ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ Ø¯Ø±Ø³Øª", "Ø­Ø§Ù„ Ø®ÙˆØ¨ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø­Ø³Ø§Ø³Ø§Øª",
  "Ù‡Ø¯Ùâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ùˆ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ", "Ø§ØµÙˆÙ„ Ù…ÙˆÙÙ‚ÛŒØª", "Ù…Ø¨Ø§Ø±Ø²Ù‡ Ø¨Ø§ Ø§ÙÚ©Ø§Ø± Ùˆ Ø§ÙØ±Ø§Ø¯ Ø³Ù…ÛŒ",
  "Ø§Ø¹ØªÙ…Ø§Ø¯Ø¨Ù‡â€ŒÙ†ÙØ³ Ùˆ Ø¹Ø²Øªâ€ŒÙ†ÙØ³", "ØªÙÚ©Ø± Ø®Ù„Ø§Ù‚ Ùˆ Ù‡ÙˆØ´ Ù‡ÛŒØ¬Ø§Ù†ÛŒ", "Ø´Ú©Ø³Øª Ùˆ ØªØ¨Ø¯ÛŒÙ„ Ø¢Ù† Ø¨Ù‡ Ù¾ÛŒØ±ÙˆØ²ÛŒ",
  "Ø´Ø®ØµÛŒØª Ú©Ø§Ø±ÛŒØ²Ù…Ø§ØªÛŒÚ©", "Ø¨Ø±Ù†Ø¯ Ø´Ø®ØµÛŒ"
];
const questionsPerArea = 5;
const questionsDiv = document.getElementById('questions');

areas.forEach(area => {
  const div = document.createElement('div');
  div.className = 'area';
  div.innerHTML = `<strong>${area}</strong><br>`;
  for (let i=1; i<=questionsPerArea; i++){
    div.innerHTML += `
      <label>Ø³Ø¤Ø§Ù„ ${i}:</label>
      <select name='${area}_q${i}' required>
        <option value=''>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
        <option value='yes'>Ø¨Ù„Ù‡</option>
        <option value='no'>Ø®ÛŒØ±</option>
      </select><br>`;
  }
  questionsDiv.appendChild(div);
});

function calculateResults(){
  const resultsArray = [];
  let totalYes = 0;
  let resultText = "";

  areas.forEach(area => {
    let yesCount = 0;
    for(let i=1;i<=questionsPerArea;i++){
      const val = document.querySelector(`[name='${area}_q${i}']`).value;
      if(val==='yes') yesCount++;
    }
    totalYes += yesCount;
    const urgent = yesCount>=3 ? "âœ… Ù†ÛŒØ§Ø² ÙÙˆØ±ÛŒ" : "âŒ Ù†ÛŒØ§Ø² ÙÙˆØ±ÛŒ Ù†Ø¯Ø§Ø±Ø¯";
    resultText += `${area}: ${yesCount} Ø¨Ù„Ù‡ - ${urgent}\n`;
    resultsArray.push({area, yes: yesCount, urgent});
  });

  resultText += `\nÙ…Ø¬Ù…ÙˆØ¹ Ú©Ù„ Ø¨Ù„Ù‡â€ŒÙ‡Ø§: ${totalYes}\n`;
  resultText += totalYes>30 ? "ğŸ“Œ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯: Ø´Ø±Ú©Øª Ø¯Ø± Ú©Ù„ Ø¯ÙˆØ±Ù‡ ØªÙˆØµÛŒÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯" : "ğŸ“Œ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯: Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¢Ù…ÙˆØ²Ø´ Ø¯Ø± Ø­ÙˆØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø´Ø®Øµ Ø´Ø¯Ù‡";
  
  document.getElementById('resultDiv').innerText = resultText;
  document.getElementById('resultDiv').style.display = 'block';

  window.latestResults = {resultsArray, totalYes};
}

function downloadCSV(){
  if(!window.latestResults){
    alert("Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ Ù†ØªØ§ÛŒØ¬ Ø±Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©Ù†ÛŒØ¯.");
    return;
  }
  const name = document.getElementById('name').value.replace(/ /g,'_') || 'user';
  let csvContent = 'data:text/csv;charset=utf-8,';
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù†Ø§Ù… Ù…Ø¯Ø±Ø³
  csvContent += `Ù…Ø¯Ø±Ø³,Ù…Ø±Ø¨ÛŒ Ø®Ø§Ù†Ù… ÙÙ‡ÛŒÙ…Ù‡ Ø­ÛŒØ§ØªÛŒ\r\n`;
  csvContent += `Ù†Ø§Ù…,Ø³Ù†,Ø´ØºÙ„,Ù‡Ø¯Ù\r\n`;
  csvContent += `${document.getElementById('name').value},${document.getElementById('age').value},${document.getElementById('job').value},${document.getElementById('goal').value}\r\n`;
  csvContent += `\r\nØ­ÙˆØ²Ù‡,ØªØ¹Ø¯Ø§Ø¯ Ø¨Ù„Ù‡,Ù†ÛŒØ§Ø² ÙÙˆØ±ÛŒ\r\n`;
  window.latestResults.resultsArray.forEach(r=>{
    csvContent += `${r.area},${r.yes},${r.urgent.replace('âœ… ','').replace('âŒ ','')}\r\n`;
  });
  csvContent += `\nÙ…Ø¬Ù…ÙˆØ¹ Ú©Ù„ Ø¨Ù„Ù‡â€ŒÙ‡Ø§,${window.latestResults.totalYes}\r\n`;
  csvContent += `Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯,${window.latestResults.totalYes>30 ? 'Ø´Ø±Ú©Øª Ø¯Ø± Ú©Ù„ Ø¯ÙˆØ±Ù‡' : 'Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¢Ù…ÙˆØ²Ø´ Ø¯Ø± Ø­ÙˆØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø´Ø®Øµ Ø´Ø¯Ù‡'}`;

  const encodedUri = encodeURI(csvContent);
  const link = document.createElement('a');
  link.setAttribute('href', encodedUri);
  link.setAttribute('download', `Ù†ØªØ§ÛŒØ¬_Ø³Ù†Ø¬Ø´_${name}.csv`);
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
</script>
</body>
</html>
